{"version":3,"sources":["webpack:///postmessenger.js","webpack:///webpack/bootstrap 49decfde801b3c787e65","webpack:///./postmessenger.js","webpack:///./postmessenger/PostMessenger.js","webpack:///../../tinyutils/src/EventObject.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_PostMessenger","_PostMessenger2","obj","default","window","PostMessenger","_classCallCheck","instance","Constructor","TypeError","value","_createClass","defineProperties","target","props","length","descriptor","writable","key","protoProps","staticProps","_EventObject","_EventObject2","DEFAULT_CHANNEL","ORIGIN_ALL","PRIVATE","WeakMap","_ref","arguments","undefined","_ref$channel","channel","_ref$origin","origin","this","eventObject","addEventListener","event","message","data","indexOf","trigger","lastEventId","ports","source","set","handler","off","on","_PRIVATE$get3","postMessage","EventObject","handlers","create","_PRIVATE$get","index","splice","_PRIVATE$get2","push","forEach","error","console"],"mappings":"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","file":"postmessenger.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _PostMessenger = __webpack_require__(1);\n\nvar _PostMessenger2 = _interopRequireDefault(_PostMessenger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nwindow.PostMessenger = _PostMessenger2.default;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _EventObject = __webpack_require__(2);\n\nvar _EventObject2 = _interopRequireDefault(_EventObject);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DEFAULT_CHANNEL = 'default';\nvar ORIGIN_ALL = '*';\nvar PRIVATE = new WeakMap();\n\nvar PostMessenger = function () {\n  function PostMessenger() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        _ref$channel = _ref.channel,\n        channel = _ref$channel === undefined ? DEFAULT_CHANNEL : _ref$channel,\n        _ref$origin = _ref.origin,\n        origin = _ref$origin === undefined ? ORIGIN_ALL : _ref$origin;\n\n    _classCallCheck(this, PostMessenger);\n\n    var eventObject = new _EventObject2.default();\n\n    window.addEventListener('message', function (event) {\n      var message = event.data;\n\n      if (message && message.channel === channel && origin.length && (origin === ORIGIN_ALL || origin.indexOf(event.origin) >= 0)) {\n        eventObject.trigger(message.name, {\n          data: message.data,\n          lastEventId: event.lastEventId,\n          origin: event.origin,\n          ports: event.ports,\n          source: event.source\n        });\n      }\n    });\n\n    PRIVATE.set(this, {\n      channel: channel,\n      eventObject: eventObject,\n      origin: origin\n    });\n  }\n\n  _createClass(PostMessenger, [{\n    key: 'off',\n    value: function off(name, handler) {\n      var _PRIVATE$get = PRIVATE.get(this),\n          eventObject = _PRIVATE$get.eventObject;\n\n      eventObject.off(name, handler);\n    }\n  }, {\n    key: 'on',\n    value: function on(name, handler) {\n      var _PRIVATE$get2 = PRIVATE.get(this),\n          eventObject = _PRIVATE$get2.eventObject;\n\n      eventObject.on(name, handler);\n    }\n  }, {\n    key: 'post',\n    value: function post(target, name, data) {\n      var _PRIVATE$get3 = PRIVATE.get(this),\n          channel = _PRIVATE$get3.channel,\n          origin = _PRIVATE$get3.origin;\n\n      target.postMessage({\n        channel: channel,\n        data: data,\n        name: name\n      }, origin);\n    }\n  }]);\n\n  return PostMessenger;\n}();\n\nexports.default = PostMessenger;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PRIVATE = new WeakMap();\n\nvar EventObject = function () {\n  function EventObject() {\n    _classCallCheck(this, EventObject);\n\n    PRIVATE.set(this, {\n      handlers: Object.create(null)\n    });\n  }\n\n  _createClass(EventObject, [{\n    key: \"off\",\n    value: function off(event, handler) {\n      var _PRIVATE$get = PRIVATE.get(this),\n          handlers = _PRIVATE$get.handlers;\n\n      if (handlers[event]) {\n        var index = handlers[event].indexOf(handler);\n        if (index >= 0) {\n          handlers[event].splice(index, 1);\n\n          if (!handlers[event].length) {\n            delete handlers[event];\n          }\n        }\n      }\n    }\n  }, {\n    key: \"on\",\n    value: function on(event, handler) {\n      var _PRIVATE$get2 = PRIVATE.get(this),\n          handlers = _PRIVATE$get2.handlers;\n\n      if (!handlers[event]) {\n        handlers[event] = [];\n      }\n\n      handlers[event].push(handler);\n    }\n  }, {\n    key: \"trigger\",\n    value: function trigger(event, data) {\n      var _PRIVATE$get3 = PRIVATE.get(this),\n          handlers = _PRIVATE$get3.handlers;\n\n      if (handlers[event]) {\n        handlers[event].forEach(function (handler) {\n          try {\n            handler(data);\n          } catch (error) {\n            console.error(error);\n          }\n        });\n      }\n    }\n  }]);\n\n  return EventObject;\n}();\n\nexports.default = EventObject;\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// postmessenger.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 49decfde801b3c787e65","import PostMessenger from './postmessenger/PostMessenger';\r\n\r\nwindow.PostMessenger = PostMessenger;\r\n\n\n\n// WEBPACK FOOTER //\n// ./postmessenger.js","import EventObject from 'tinyutils/src/EventObject';\r\n\r\nconst DEFAULT_CHANNEL = 'default';\r\nconst ORIGIN_ALL = '*';\r\nconst PRIVATE = new WeakMap();\r\n\r\nexport default class PostMessenger {\r\n  constructor({channel = DEFAULT_CHANNEL, origin = ORIGIN_ALL} = {}) {\r\n    let eventObject = new EventObject();\r\n\r\n    window.addEventListener('message', (event) => {\r\n      let message = event.data;\r\n\r\n      if (\r\n        message &&\r\n        message.channel === channel &&\r\n        origin.length &&\r\n        (origin === ORIGIN_ALL || origin.indexOf(event.origin) >= 0)\r\n      ) {\r\n        eventObject.trigger(message.name, {\r\n          data: message.data,\r\n          lastEventId: event.lastEventId,\r\n          origin: event.origin,\r\n          ports: event.ports,\r\n          source: event.source\r\n        });\r\n      }\r\n    });\r\n\r\n    PRIVATE.set(this, {\r\n      channel,\r\n      eventObject,\r\n      origin\r\n    });\r\n  }\r\n\r\n  off(name, handler) {\r\n    let {eventObject} = PRIVATE.get(this);\r\n\r\n    eventObject.off(name, handler);\r\n  }\r\n\r\n  on(name, handler) {\r\n    let {eventObject} = PRIVATE.get(this);\r\n\r\n    eventObject.on(name, handler);\r\n  }\r\n\r\n  post(target, name, data) {\r\n    let {channel, origin} = PRIVATE.get(this);\r\n\r\n    target.postMessage({\r\n      channel,\r\n      data,\r\n      name\r\n    }, origin);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./postmessenger/PostMessenger.js","const PRIVATE = new WeakMap();\r\n\r\nexport default class EventObject {\r\n  constructor() {\r\n    PRIVATE.set(this, {\r\n      handlers: Object.create(null)\r\n    });\r\n  }\r\n\r\n  off(event, handler) {\r\n    let {handlers} = PRIVATE.get(this);\r\n\r\n    if (handlers[event]) {\r\n      let index = handlers[event].indexOf(handler);\r\n      if (index >= 0) {\r\n        handlers[event].splice(index, 1);\r\n\r\n        if (!handlers[event].length) {\r\n          delete handlers[event];\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  on(event, handler) {\r\n    let {handlers} = PRIVATE.get(this);\r\n\r\n    if (!handlers[event]) {\r\n      handlers[event] = [];\r\n    }\r\n\r\n    handlers[event].push(handler);\r\n  }\r\n\r\n  trigger(event, data) {\r\n    let {handlers} = PRIVATE.get(this);\r\n\r\n    if (handlers[event]) {\r\n      handlers[event].forEach((handler) => {\r\n        try {\r\n          handler(data);\r\n        } catch (error) {\r\n          console.error(error);\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ../../tinyutils/src/EventObject.js"],"sourceRoot":""}